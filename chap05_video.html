<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>#5 video</title>
    <style type="text/css">

        html, body{
            margin: 0px; padding:0px; border: 0; width: 100%; height: 100%;
        }

        .drop_item{
            margin: 0px; width: 100%; height: 100%; display: table;
        }

        .video_item{
            border: 1px solid #009;
            display: block;
        }

    </style>
    <script type="text/javascript">

        function init()
        {
            // file drop
            initDroparea();

            // video
            initVideo();

            // video event
            addVideoEvent();

            // keyboard event
            addKeyEvent()
        }


        //===============================================   #1
        var video;
        function initVideo()
        {

        }

        function loadVideo(name, path)
        {

        }



        //===============================================  #2
        function addVideoEvent()
        {

        }

        var isVideo, videoW, videoH, videoRatio, videoTotalTime;
        function onLoadedVideo()
        {
            isVideo = true;

            // todo




            updateVideoSize();
            // 구간 반복용.
            resetRepeat();
            startTimer();

            video.play();
        }



        //===============================================  #3
        function updateVideoSize()
        {
            if ( !isVideo )
                return;

            // todo
            var dw, dh, vw, vh;

        }



        //===============================================  #4
        function addKeyEvent()
        {

        }

        function onKeyupEvent(ke)
        {
            if ( !isVideo )
                return;

            var keyCode = ke.keyCode;

            switch(keyCode)
            {
                case 32: toggleVideo(); break; // space bar
                case 37: seekVideo(-1); break; // left
                case 39: seekVideo(1); break; // right
                case 38: updateVolume(1); break; // up
                case 40: updateVolume(-1); break; // down

                case 188: speedUp(-1); break; // <
                case 190: speedUp(1); break; // >
                case 191: speedUp(0); break; // ?

                case 219: setRepeat(false); break; // [
                case 221: setRepeat(true); break; // ]
                case 220: resetRepeat(); break; // \
            }
        }



        //===============================================  #5
        function toggleVideo()
        {

        }


        //===============================================  #6
        var seekDist = 2;
        function seekVideo(dir)
        {
            resetRepeat();

            // todo

        }


        //===============================================  #7
        var volumeDist = 0.1;
        function updateVolume(dir)
        {

        }


        //===============================================  #8
        var speedDist = 0.1;
        function speedUp(dir)
        {

        }


        //===============================================  #9
        var videoTimer;
        function startTimer()
        {

        }

        function stopTimer()
        {

        }

        function progressTimer()
        {
            checkRepeat();

            // todo

        }

        //===============================================  #10
        // repeat
        var repeatInfo = {start:-1, end:-1};
        function setRepeat(isEnd)
        {
            // todo
        }

        function resetRepeat()
        {
            repeatInfo = {start:-1, end:-1};
        }

        function checkRepeat()
        {
            if ( repeatInfo.start != -1 && repeatInfo.end != -1 )
            {
                if ( video.currentTime > repeatInfo.end )
                    video.currentTime = repeatInfo.start;
            }
        }











        // FILE
        function initDroparea()
        {
            droparea = document.getElementById('droparea')
            droparea.addEventListener('dragover', onMouseDrag);
            droparea.addEventListener('drop', onMouseDrop);
        }

        // file drag, drop
        function onMouseDrag(me)
        {
            me.preventDefault();
        }

        function onMouseDrop(me)
        {
            onMouseDrag(me);
            checkDropFile(me);
        }

        function checkDropFile(me)
        {
            var files = me.target.files || me.dataTransfer.files;
            if ( !files || files.length < 1 )
                return;

            var file = files[0];
            if ( file.type != 'video/mp4' )
                return;

            var path = URL.createObjectURL( file );

            loadVideo(file.name, path);
        }






        window.onload = init;

    </script>

</head>
<body>

<div id="droparea" class="drop_item">
    <video id="video" class="video_item"></video>
</div>

</body>
</html>